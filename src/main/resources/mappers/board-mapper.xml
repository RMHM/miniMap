<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">

	<resultMap type="Board" id="boardMap"></resultMap>
	<!-- <resultMap type="Fileref" id="fileMap"></resultMap> -->
	
	<select id="selectBoardList" resultType="board">
		SELECT A.*, (SELECT
		COUNT(*) FROM FILEREF WHERE BID = A.BID) FILECOUNT
		FROM
		BOARD A WHERE BCODE='1'	AND ISNOTICE='N' AND DELFLAG='N' AND RFLAG='N'
		ORDER BY BDATE DESC, BNO DESC		
	</select>
	<select id="selectNoticeList" resultType="board">
		SELECT A.*, (SELECT
		COUNT(*) FROM FILEREF WHERE BID = A.BID) FILECOUNT
		FROM
		BOARD A WHERE BCODE='1'	AND ISNOTICE='Y'	
		ORDER BY BDATE DESC, BNO DESC		
	</select>	
	
	<select id="selectBoardTotalContents" resultType="_int">
		SELECT COUNT(*)
		FROM BOARD
	</select>
	<select id="selectOneBoard" parameterType="_int"
		resultType="Board">
		SELECT * FROM BOARD WHERE BID = #{bId}		
	</select>
	<update id="updateOneCount">
		UPDATE BOARD SET BCOUNT = BCOUNT+1  WHERE BID= #{bId}
	</update>
	
	<insert id="insertBoard">
		INSERT INTO BOARD(BID, MNO, BNO, BCODE, BTITLE, BCONTENT)
		VALUES
		(SEQ_BID.NEXTVAL,#{mNo},SEQ_BNO_1.NEXTVAL,'1',#{bTitle},#{bContent})
		<!-- 전달한 board객체의 boardNo 프로퍼티에 결과값을 담는다. -->
		<selectKey keyProperty="boardNo" resultType="_int"
			order="AFTER">
			SELECT SEQ_BID.CURRVAL FROM DUAL
		</selectKey>
	</insert>
	
	

</mapper>